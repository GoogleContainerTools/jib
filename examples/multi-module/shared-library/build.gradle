plugins {
  id 'java'
  id 'eclipse'
  id 'idea'
  id 'maven-publish'
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

// Since this library is included as a jar in our jib projects, we want the
// jar to built reproducibly.
jar {
  preserveFileTimestamps false
  reproducibleFileOrder true
}

publishing {
  repositories {
    maven {
      name = 'GitHub'
      allowInsecureProtocol true
      url 'https://maven.pkg.github.com/smvlada/jib'
      credentials {
        username 'smvlada'
        password project.findProperty('GITHUB_TOKEN')
      }
    }
  }
  publications {
    maven(MavenPublication) {
      groupId 'net.example'
      artifactId "${rootProject.name}-${project.name}"
      version "${version}"
      from components.java
    }
  }
}

afterReleaseBuild.dependsOn publish

